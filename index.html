<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css"> @import url(https://themes.googleusercontent.com/fonts/css?kit=kbffV7V9BIH3Ot2AQ2LQRA);</style></head><body class="doc-content" style="background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt"><p style="padding:0;margin:0;color:#000000;font-size:11pt;font-family:&quot;Arial&quot;;line-height:1.0;text-align:left"><span style="color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:&quot;Courier&quot;;font-style:normal">&lt;!DOCTYPE html&gt;<br>&lt;html lang=&quot;ar&quot; dir=&quot;rtl&quot;&gt;<br>&lt;head&gt;<br> &nbsp; &nbsp;&lt;meta charset=&quot;UTF-8&quot;&gt;<br> &nbsp; &nbsp;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;<br> &nbsp; &nbsp;&lt;title&gt;&#1587;&#1604;&#1601;&#1577; &#1588;&#1593;&#1576;&#1610;&#1577;&lt;/title&gt;<br> &nbsp; &nbsp;&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;<br> &nbsp; &nbsp;&lt;style&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;@import url(&#39;https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&amp;display=swap&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;body {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;font-family: &#39;Tajawal&#39;, sans-serif;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background-color: #f0f2f5;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.container {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max-width: 420px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;margin: auto;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;min-height: 100vh;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: flex;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;flex-direction: column;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;justify-content: space-between;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background-color: white;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.modal {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: none;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;position: fixed;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;top: 0;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;left: 0;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;width: 100%;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;height: 100%;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background-color: rgba(0, 0, 0, 0.5);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;justify-content: center;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;align-items: center;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;z-index: 100;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.modal-content {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background-color: white;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;padding: 24px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border-radius: 12px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text-align: center;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max-width: 350px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;animation: fadeIn 0.3s ease-out;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;@keyframes fadeIn {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;from { opacity: 0; transform: translateY(-20px); }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to { opacity: 1; transform: translateY(0); }<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.lottery-icon {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;font-size: 80px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color: #4CAF50;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;animation: spin 2s infinite ease-in-out;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;@keyframes spin {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0% { transform: scale(1) rotate(0deg); }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;50% { transform: scale(1.2) rotate(180deg); }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;100% { transform: scale(1) rotate(360deg); }<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.payment-status-icon {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;font-size: 24px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text-align: center;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.paid-icon { color: #4CAF50; }<br> &nbsp; &nbsp; &nbsp; &nbsp;.unpaid-icon { color: #F44336; }<br> &nbsp; &nbsp; &nbsp; &nbsp;.received-icon { color: #FFC107; }<br> &nbsp; &nbsp; &nbsp; &nbsp;.chat-container {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;flex-grow: 1;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;overflow-y: auto;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: flex;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;flex-direction: column-reverse;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.message-bubble {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max-width: 80%;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;padding: 8px 12px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border-radius: 18px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;margin-bottom: 8px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line-height: 1.4;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.my-message {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background-color: #4CAF50;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color: white;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;align-self: flex-end;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border-bottom-left-radius: 2px;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.other-message {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;background-color: #e5e5ea;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;color: #000;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;align-self: flex-start;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border-bottom-right-radius: 2px;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body class=&quot;bg-gray-100 flex items-center justify-center p-4&quot;&gt;<br><br>&lt;!-- Main App Container --&gt;<br>&lt;div class=&quot;container rounded-2xl shadow-xl flex flex-col h-full w-full&quot;&gt;<br><br> &nbsp; &nbsp;&lt;!-- Screen - Login/User Selection --&gt;<br> &nbsp; &nbsp;&lt;div id=&quot;login-screen&quot; class=&quot;screen flex flex-col items-center justify-center p-8 text-center bg-gray-50 h-full&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;h1 class=&quot;text-4xl font-bold text-green-600 mb-2&quot;&gt;&#1587;&#1604;&#1601;&#1577; &#1588;&#1593;&#1576;&#1610;&#1577;&lt;/h1&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-lg text-gray-700 mb-8&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#1578;&#1606;&#1592;&#1610;&#1605; &#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1575;&#1578; &#1575;&#1604;&#1588;&#1593;&#1576;&#1610;&#1577; &#1576;&#1587;&#1607;&#1608;&#1604;&#1577; &#1608;&#1579;&#1602;&#1577;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-xs text-gray-500 mb-4&quot;&gt;&#1604;&#1604;&#1578;&#1580;&#1585;&#1576;&#1577;&#1548; &#1571;&#1583;&#1582;&#1604; &#1575;&#1587;&#1605; &#1575;&#1604;&#1605;&#1587;&#1578;&#1582;&#1583;&#1605; &#1575;&#1604;&#1582;&#1575;&#1589; &#1576;&#1603;.&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;text&quot; id=&quot;username-input&quot; placeholder=&quot;&#1575;&#1587;&#1605; &#1575;&#1604;&#1605;&#1587;&#1578;&#1582;&#1583;&#1605;&quot; class=&quot;w-full text-center p-3 rounded-md border-gray-300 shadow-sm mb-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;start-app-btn&quot; class=&quot;w-full bg-green-600 text-white p-3 rounded-md shadow-md hover:bg-green-700 transition&quot;&gt;&#1575;&#1576;&#1583;&#1571;&lt;/button&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;!-- Screen - Home (Groups List) --&gt;<br> &nbsp; &nbsp;&lt;div id=&quot;home-screen&quot; class=&quot;screen hidden flex-1 p-4 flex flex-col&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex items-center justify-between mb-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-bold&quot;&gt;&#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1575;&#1578;&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex items-center space-x-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;create-group-btn&quot; class=&quot;bg-green-600 text-white p-2 rounded-full shadow-md hover:bg-green-700 transition&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot; stroke-width=&quot;2&quot; stroke=&quot;currentColor&quot; class=&quot;w-6 h-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M12 4.5v15m7.5-7.5h-15&quot; /&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;join-group-btn&quot; class=&quot;bg-gray-200 text-gray-800 p-2 rounded-full shadow-md hover:bg-gray-300 transition&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot; stroke-width=&quot;2&quot; stroke=&quot;currentColor&quot; class=&quot;w-6 h-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M18 18.75c-.328 0-.64-.092-.91-.26-.27-.168-1.246-.867-2.73-1.425C13.267 16.5 12 16.5 12 16.5s-1.267 0-2.36-.815c-1.485-.558-2.46-1.257-2.73-1.425-.27-.168-.582-.26-.91-.26a3.75 3.75 0 110-7.5c.328 0 .64.092.91.26.27.168 1.246.867 2.73 1.425C10.733 7.5 12 7.5 12 7.5s1.267 0 2.36.815c1.485.558 2.46 1.257 2.73 1.425.27.168.582.26.91.26a3.75 3.75 0 110 7.5zM12 12a.75.75 0 100-1.5.75.75 0 000 1.5z&quot; /&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;groups-list&quot; class=&quot;flex-1 overflow-y-auto space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Groups will be dynamically added here --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;p id=&quot;user-id-display&quot; class=&quot;text-xs text-center text-gray-400 mt-4&quot;&gt;&lt;/p&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;!-- Screen - Create Group --&gt;<br> &nbsp; &nbsp;&lt;div id=&quot;create-group-screen&quot; class=&quot;screen hidden p-4 flex-1&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-bold mb-4&quot;&gt;&#1573;&#1606;&#1588;&#1575;&#1569; &#1580;&#1605;&#1593;&#1610;&#1577; &#1580;&#1583;&#1610;&#1583;&#1577;&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;create-group-form&quot; class=&quot;space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;label for=&quot;group-name&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;&#1575;&#1587;&#1605; &#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577;&lt;/label&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;text&quot; id=&quot;group-name&quot; class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;label for=&quot;member-count&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;&#1593;&#1583;&#1583; &#1575;&#1604;&#1571;&#1593;&#1590;&#1575;&#1569;&lt;/label&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;number&quot; id=&quot;member-count&quot; min=&quot;2&quot; class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;label for=&quot;monthly-amount&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;&#1575;&#1604;&#1605;&#1576;&#1604;&#1594; &#1575;&#1604;&#1588;&#1607;&#1585;&#1610; (&#1583;&#1610;&#1606;&#1575;&#1585; &#1593;&#1585;&#1575;&#1602;&#1610;)&lt;/label&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;number&quot; id=&quot;monthly-amount&quot; min=&quot;1000&quot; class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;label class=&quot;block text-sm font-medium text-gray-700&quot;&gt;&#1591;&#1585;&#1610;&#1602;&#1577; &#1575;&#1604;&#1583;&#1608;&#1585;&lt;/label&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;mt-1 space-x-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;label class=&quot;inline-flex items-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;radio&quot; name=&quot;lottery-method&quot; value=&quot;lottery&quot; class=&quot;form-radio&quot; checked&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;ml-2&quot;&gt;&#1602;&#1585;&#1593;&#1577;&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/label&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;label class=&quot;inline-flex items-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;radio&quot; name=&quot;lottery-method&quot; value=&quot;manual&quot; class=&quot;form-radio&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;ml-2&quot;&gt;&#1578;&#1585;&#1578;&#1610;&#1576; &#1610;&#1583;&#1608;&#1610;&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/label&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;w-full bg-green-600 text-white p-3 rounded-md shadow-md hover:bg-green-700 transition&quot;&gt;&#1573;&#1606;&#1588;&#1575;&#1569; &#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;cancel-create-group&quot; class=&quot;w-full mt-2 text-gray-600 p-3 rounded-md hover:bg-gray-200 transition&quot;&gt;&#1573;&#1604;&#1594;&#1575;&#1569;&lt;/button&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;!-- Screen - Join Group --&gt;<br> &nbsp; &nbsp;&lt;div id=&quot;join-group-screen&quot; class=&quot;screen hidden p-4 flex-1&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 class=&quot;text-2xl font-bold mb-4&quot;&gt;&#1575;&#1604;&#1575;&#1606;&#1590;&#1605;&#1575;&#1605; &#1573;&#1604;&#1609; &#1580;&#1605;&#1593;&#1610;&#1577;&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;join-group-form&quot; class=&quot;space-y-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;label for=&quot;join-code&quot; class=&quot;block text-sm font-medium text-gray-700&quot;&gt;&#1571;&#1583;&#1582;&#1604; &#1603;&#1608;&#1583; &#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577;&lt;/label&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;text&quot; id=&quot;join-code&quot; class=&quot;mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2&quot; required&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;w-full bg-green-600 text-white p-3 rounded-md shadow-md hover:bg-green-700 transition&quot;&gt;&#1575;&#1604;&#1575;&#1606;&#1590;&#1605;&#1575;&#1605;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;cancel-join-group&quot; class=&quot;w-full mt-2 text-gray-600 p-3 rounded-md hover:bg-gray-200 transition&quot;&gt;&#1573;&#1604;&#1594;&#1575;&#1569;&lt;/button&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;!-- Screen - Group Details/Dashboard --&gt;<br> &nbsp; &nbsp;&lt;div id=&quot;group-dashboard-screen&quot; class=&quot;screen hidden p-4 flex-1 flex flex-col&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex items-center justify-between mb-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h2 id=&quot;group-title&quot; class=&quot;text-2xl font-bold&quot;&gt;&lt;/h2&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex space-x-2&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;share-code-btn&quot; class=&quot;text-sm bg-gray-200 p-2 rounded-full&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot; stroke-width=&quot;1.5&quot; stroke=&quot;currentColor&quot; class=&quot;w-6 h-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.28.68.28 1.093s-.1.77-.28 1.093m0-2.186l9.566-5.315a3.75 3.75 0 00-2.222-2.915m2.222 2.915a3.75 3.75 0 00-2.585.832m.878 12.049l9.566-5.315c.801.402 1.571 1.034 2.176 1.831a3.75 3.75 0 00-2.585-.832m-8.79 2.186a2.25 2.25 0 110 2.186m0-2.186c.18.324.28.68.28 1.093s-.1.77-.28 1.093m-2.222-2.915a3.75 3.75 0 00-2.585.832m.878 12.049l9.566-5.315a3.75 3.75 0 00-2.585-.832M15 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z&quot; /&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;leave-group-btn&quot; class=&quot;text-sm text-red-500&quot;&gt;&#1605;&#1594;&#1575;&#1583;&#1585;&#1577;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;group-info&quot; class=&quot;text-sm text-gray-600 mb-4&quot;&gt;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Tab Navigation --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex justify-around mb-4 border-b border-gray-200&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button class=&quot;tab-button p-2 text-gray-600 font-medium border-b-2 border-transparent transition&quot; data-tab=&quot;dashboard&quot;&gt;&#1575;&#1604;&#1580;&#1583;&#1608;&#1604;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;lottery-tab-btn&quot; class=&quot;tab-button p-2 text-gray-600 font-medium border-b-2 border-transparent transition&quot; data-tab=&quot;lottery&quot;&gt;&#1575;&#1604;&#1602;&#1585;&#1593;&#1577;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button class=&quot;tab-button p-2 text-gray-600 font-medium border-b-2 border-transparent transition&quot; data-tab=&quot;chat&quot;&gt;&#1575;&#1604;&#1583;&#1585;&#1583;&#1588;&#1577;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Dashboard Tab Content --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;dashboard-tab&quot; class=&quot;tab-content flex-1 overflow-y-auto&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;table class=&quot;w-full text-sm text-right text-gray-500&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;thead class=&quot;text-xs text-gray-700 uppercase bg-gray-50 rounded-t-lg&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;tr&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;th scope=&quot;col&quot; class=&quot;py-3 px-2 rounded-tr-lg&quot;&gt;&#1575;&#1604;&#1593;&#1590;&#1608;&lt;/th&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;th scope=&quot;col&quot; class=&quot;py-3 px-2&quot;&gt;&#1575;&#1604;&#1581;&#1575;&#1604;&#1577;&lt;/th&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;th scope=&quot;col&quot; class=&quot;py-3 px-2 rounded-tl-lg&quot;&gt;&#1575;&#1587;&#1578;&#1604;&#1605;&lt;/th&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/tr&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/thead&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;tbody id=&quot;members-table-body&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Members will be dynamically added here --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/tbody&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/table&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Lottery Tab Content --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;lottery-tab&quot; class=&quot;tab-content hidden flex-1 flex flex-col items-center justify-center p-4 text-center&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-lg text-gray-600 mb-4&quot;&gt;&#1575;&#1590;&#1594;&#1591; &#1593;&#1604;&#1609; &#1575;&#1604;&#1586;&#1585; &#1604;&#1573;&#1580;&#1585;&#1575;&#1569; &#1575;&#1604;&#1602;&#1585;&#1593;&#1577; &#1575;&#1604;&#1588;&#1607;&#1585;&#1610;&#1577;.&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;lottery-animation&quot; class=&quot;text-center mb-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;currentColor&quot; class=&quot;w-24 h-24 text-green-600 animate-bounce&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM12.75 6a.75.75 0 00-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 000-1.5h-3.75V6z&quot; clip-rule=&quot;evenodd&quot; /&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;run-lottery-btn&quot; class=&quot;bg-green-600 text-white px-6 py-3 rounded-full shadow-md hover:bg-green-700 transition&quot;&gt;&#1573;&#1580;&#1585;&#1575;&#1569; &#1575;&#1604;&#1602;&#1585;&#1593;&#1577;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Chat Tab Content --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;chat-tab&quot; class=&quot;tab-content hidden flex-1 flex flex-col&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;chat-messages&quot; class=&quot;flex-1 overflow-y-auto p-4 flex flex-col-reverse&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Chat messages will be dynamically added here --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;form id=&quot;chat-form&quot; class=&quot;flex items-center mt-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;input type=&quot;text&quot; id=&quot;chat-input&quot; placeholder=&quot;&#1575;&#1603;&#1578;&#1576; &#1585;&#1587;&#1575;&#1604;&#1577;...&quot; class=&quot;flex-1 rounded-full border border-gray-300 p-2 pl-4 focus:outline-none focus:ring-2 focus:ring-green-500&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button type=&quot;submit&quot; class=&quot;bg-green-600 text-white p-3 rounded-full ml-2 shadow-md hover:bg-green-700 transition&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 24 24&quot; fill=&quot;currentColor&quot; class=&quot;w-6 h-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;path d=&quot;M3.478 2.405a.75.75 0 00-.926.94l2.432 7.917H13.5a.75.75 0 010 1.5H4.984l-2.432 7.917a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z&quot; /&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/form&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- Floating Action Button for Back Navigation --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;back-home-btn&quot; class=&quot;fixed bottom-4 right-4 bg-gray-800 text-white p-4 rounded-full shadow-lg hover:bg-gray-700 transition&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot; stroke-width=&quot;2.5&quot; stroke=&quot;currentColor&quot; class=&quot;w-6 h-6&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;path stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot; d=&quot;M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18&quot; /&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/svg&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br><br> &nbsp; &nbsp;&lt;/div&gt;<br><br>&lt;/div&gt;<br><br>&lt;!-- Custom Modal for Alerts/Notifications --&gt;<br>&lt;div id=&quot;app-modal&quot; class=&quot;modal&quot;&gt;<br> &nbsp; &nbsp;&lt;div class=&quot;modal-content&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 id=&quot;modal-title&quot; class=&quot;text-xl font-bold mb-2&quot;&gt;&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;p id=&quot;modal-message&quot; class=&quot;text-gray-600 mb-4&quot;&gt;&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;modal-ok-btn&quot; class=&quot;bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 transition&quot;&gt;&#1605;&#1608;&#1575;&#1601;&#1602;&lt;/button&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br>&lt;/div&gt;<br><br>&lt;script type=&quot;module&quot;&gt;<br> &nbsp; &nbsp;// Firebase Imports<br> &nbsp; &nbsp;import { initializeApp } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js&quot;;<br> &nbsp; &nbsp;import { getAuth, signInWithCustomToken, signInAnonymously } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js&quot;;<br> &nbsp; &nbsp;import { getFirestore, doc, getDoc, setDoc, collection, query, where, addDoc, getDocs, onSnapshot, runTransaction, serverTimestamp, arrayUnion } from &quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js&quot;;<br><br> &nbsp; &nbsp;// --- Firebase Initialization ---<br> &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;<br> &nbsp; &nbsp;const firebaseConfig = typeof __firebase_config !== &#39;undefined&#39; ? JSON.parse(__firebase_config) : {};<br> &nbsp; &nbsp;const initialAuthToken = typeof __initial_auth_token !== &#39;undefined&#39; ? __initial_auth_token : null;<br><br> &nbsp; &nbsp;let app, db, auth;<br> &nbsp; &nbsp;let userId;<br> &nbsp; &nbsp;let username;<br> &nbsp; &nbsp;let currentGroupId = null;<br> &nbsp; &nbsp;let isAuthReady = false;<br><br> &nbsp; &nbsp;// UI elements<br> &nbsp; &nbsp;const screens = {<br> &nbsp; &nbsp; &nbsp; &nbsp;login: document.getElementById(&#39;login-screen&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp;home: document.getElementById(&#39;home-screen&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp;createGroup: document.getElementById(&#39;create-group-screen&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp;joinGroup: document.getElementById(&#39;join-group-screen&#39;),<br> &nbsp; &nbsp; &nbsp; &nbsp;dashboard: document.getElementById(&#39;group-dashboard-screen&#39;)<br> &nbsp; &nbsp;};<br> &nbsp; &nbsp;const showScreen = (screenId) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;Object.values(screens).forEach(s =&gt; s.classList.add(&#39;hidden&#39;));<br> &nbsp; &nbsp; &nbsp; &nbsp;screens[screenId].classList.remove(&#39;hidden&#39;);<br> &nbsp; &nbsp;};<br><br> &nbsp; &nbsp;// Custom Modal functions (replaces alert and confirm)<br> &nbsp; &nbsp;const modal = document.getElementById(&#39;app-modal&#39;);<br> &nbsp; &nbsp;const modalTitle = document.getElementById(&#39;modal-title&#39;);<br> &nbsp; &nbsp;const modalMessage = document.getElementById(&#39;modal-message&#39;);<br> &nbsp; &nbsp;const modalOkBtn = document.getElementById(&#39;modal-ok-btn&#39;);<br> &nbsp; &nbsp;const showModal = (title, message) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;modalTitle.textContent = title;<br> &nbsp; &nbsp; &nbsp; &nbsp;modalMessage.textContent = message;<br> &nbsp; &nbsp; &nbsp; &nbsp;modal.style.display = &#39;flex&#39;;<br> &nbsp; &nbsp;};<br> &nbsp; &nbsp;modalOkBtn.addEventListener(&#39;click&#39;, () =&gt; modal.style.display = &#39;none&#39;);<br><br> &nbsp; &nbsp;// --- Main Application Logic ---<br> &nbsp; &nbsp;const appInitializer = async () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;app = initializeApp(firebaseConfig);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;auth = getAuth(app);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db = getFirestore(app);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (initialAuthToken) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await signInWithCustomToken(auth, initialAuthToken);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await signInAnonymously(auth);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;userId = auth.currentUser.uid;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;isAuthReady = true;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showScreen(&#39;login&#39;);<br><br> &nbsp; &nbsp; &nbsp; &nbsp;} catch (e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error initializing Firebase:&quot;, e);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1582;&#1591;&#1571;&quot;, &quot;&#1601;&#1588;&#1604; &#1601;&#1610; &#1578;&#1607;&#1610;&#1574;&#1577; &#1575;&#1604;&#1578;&#1591;&#1576;&#1610;&#1602;. &#1610;&#1585;&#1580;&#1609; &#1575;&#1604;&#1605;&#1581;&#1575;&#1608;&#1604;&#1577; &#1604;&#1575;&#1581;&#1602;&#1611;&#1575;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;};<br><br> &nbsp; &nbsp;document.getElementById(&#39;start-app-btn&#39;).addEventListener(&#39;click&#39;, async () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;const usernameInput = document.getElementById(&#39;username-input&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;username = usernameInput.value.trim();<br> &nbsp; &nbsp; &nbsp; &nbsp;if (username === &quot;&quot;) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1582;&#1591;&#1571;&quot;, &quot;&#1575;&#1604;&#1585;&#1580;&#1575;&#1569; &#1573;&#1583;&#1582;&#1575;&#1604; &#1575;&#1587;&#1605; &#1605;&#1587;&#1578;&#1582;&#1583;&#1605;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;user-id-display&#39;).textContent = `&#1575;&#1587;&#1605; &#1575;&#1604;&#1605;&#1587;&#1578;&#1582;&#1583;&#1605;: ${username} | ID: ${userId}`;<br> &nbsp; &nbsp; &nbsp; &nbsp;await loadGroups();<br> &nbsp; &nbsp; &nbsp; &nbsp;showScreen(&#39;home&#39;);<br> &nbsp; &nbsp;});<br><br> &nbsp; &nbsp;// --- Group Management ---<br> &nbsp; &nbsp;const loadGroups = async () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;if (!isAuthReady) return;<br> &nbsp; &nbsp; &nbsp; &nbsp;const groupsList = document.getElementById(&#39;groups-list&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;groupsList.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp;const groupsRef = collection(db, `artifacts/${appId}/public/data/groups`);<br> &nbsp; &nbsp; &nbsp; &nbsp;const q = query(groupsRef, where(&quot;members&quot;, &quot;array-contains&quot;, userId));<br> &nbsp; &nbsp; &nbsp; &nbsp;const querySnapshot = await getDocs(q);<br><br> &nbsp; &nbsp; &nbsp; &nbsp;if (querySnapshot.empty) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;groupsList.innerHTML = &#39;&lt;p class=&quot;text-center text-gray-500 mt-8&quot;&gt;&#1604;&#1575; &#1578;&#1608;&#1580;&#1583; &#1580;&#1605;&#1593;&#1610;&#1575;&#1578; &#1581;&#1578;&#1609; &#1575;&#1604;&#1570;&#1606;. &#1602;&#1605; &#1576;&#1573;&#1606;&#1588;&#1575;&#1569; &#1608;&#1575;&#1581;&#1583;&#1577;!&lt;/p&gt;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;querySnapshot.forEach((doc) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const group = doc.data();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const groupElement = document.createElement(&#39;div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;groupElement.className = &#39;bg-white p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;groupElement.innerHTML = `<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;text-xl font-bold&quot;&gt;${group.name}&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-gray-600 text-sm&quot;&gt;&#1593;&#1583;&#1583; &#1575;&#1604;&#1571;&#1593;&#1590;&#1575;&#1569;: ${group.memberCount}&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;groupElement.addEventListener(&#39;click&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;currentGroupId = doc.id;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loadGroupDashboard();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;groupsList.appendChild(groupElement);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;};<br><br> &nbsp; &nbsp;// Create Group Form Submission<br> &nbsp; &nbsp;document.getElementById(&#39;create-group-form&#39;).addEventListener(&#39;submit&#39;, async (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;e.preventDefault();<br> &nbsp; &nbsp; &nbsp; &nbsp;if (!isAuthReady) return;<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;const groupName = document.getElementById(&#39;group-name&#39;).value;<br> &nbsp; &nbsp; &nbsp; &nbsp;const memberCount = parseInt(document.getElementById(&#39;member-count&#39;).value);<br> &nbsp; &nbsp; &nbsp; &nbsp;const monthlyAmount = parseInt(document.getElementById(&#39;monthly-amount&#39;).value);<br> &nbsp; &nbsp; &nbsp; &nbsp;const method = document.querySelector(&#39;input[name=&quot;lottery-method&quot;]:checked&#39;).value;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const groupRef = doc(collection(db, `artifacts/${appId}/public/data/groups`));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const newGroup = {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name: groupName,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberCount: memberCount,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;monthlyAmount: monthlyAmount,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;method: method,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ownerId: userId,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;members: [userId],<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberNames: { [userId]: username },<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;payments: {},<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;received: [],<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;createdAt: serverTimestamp()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(groupRef, newGroup);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1578;&#1605;&quot;, &quot;&#1578;&#1605; &#1573;&#1606;&#1588;&#1575;&#1569; &#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577; &#1576;&#1606;&#1580;&#1575;&#1581;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await loadGroups();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showScreen(&#39;home&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;} catch (e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error creating group:&quot;, e);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1582;&#1591;&#1571;&quot;, &quot;&#1601;&#1588;&#1604; &#1601;&#1610; &#1573;&#1606;&#1588;&#1575;&#1569; &#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577;. &#1610;&#1585;&#1580;&#1609; &#1575;&#1604;&#1605;&#1581;&#1575;&#1608;&#1604;&#1577; &#1605;&#1585;&#1577; &#1571;&#1582;&#1585;&#1609;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;});<br><br> &nbsp; &nbsp;// Join Group Form Submission<br> &nbsp; &nbsp;document.getElementById(&#39;join-group-form&#39;).addEventListener(&#39;submit&#39;, async (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;e.preventDefault();<br> &nbsp; &nbsp; &nbsp; &nbsp;if (!isAuthReady) return;<br> &nbsp; &nbsp; &nbsp; &nbsp;const joinCode = document.getElementById(&#39;join-code&#39;).value.trim();<br> &nbsp; &nbsp; &nbsp; &nbsp;if (!joinCode) return;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const groupRef = doc(db, `artifacts/${appId}/public/data/groups`, joinCode);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const docSnap = await getDoc(groupRef);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (docSnap.exists()) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const groupData = docSnap.data();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (groupData.members.includes(userId)) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1578;&#1606;&#1576;&#1610;&#1607;&quot;, &quot;&#1571;&#1606;&#1578; &#1576;&#1575;&#1604;&#1601;&#1593;&#1604; &#1593;&#1590;&#1608; &#1601;&#1610; &#1607;&#1584;&#1607; &#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (groupData.members.length &gt;= groupData.memberCount) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1578;&#1606;&#1576;&#1610;&#1607;&quot;, &quot;&#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577; &#1605;&#1603;&#1578;&#1605;&#1604;&#1577;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(groupRef, {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;members: arrayUnion(userId),<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberNames: { ...groupData.memberNames, [userId]: username }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}, { merge: true });<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1578;&#1605;&quot;, `&#1578;&#1605; &#1575;&#1604;&#1575;&#1606;&#1590;&#1605;&#1575;&#1605; &#1573;&#1604;&#1609; &#1580;&#1605;&#1593;&#1610;&#1577; &quot;${groupData.name}&quot; &#1576;&#1606;&#1580;&#1575;&#1581;.`);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await loadGroups();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showScreen(&#39;home&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1582;&#1591;&#1571;&quot;, &quot;&#1603;&#1608;&#1583; &#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577; &#1594;&#1610;&#1585; &#1589;&#1581;&#1610;&#1581;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;} catch (e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error joining group:&quot;, e);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1582;&#1591;&#1571;&quot;, &quot;&#1581;&#1583;&#1579; &#1582;&#1591;&#1571; &#1571;&#1579;&#1606;&#1575;&#1569; &#1575;&#1604;&#1575;&#1606;&#1590;&#1605;&#1575;&#1605;. &#1610;&#1585;&#1580;&#1609; &#1575;&#1604;&#1578;&#1581;&#1602;&#1602; &#1605;&#1606; &#1575;&#1604;&#1603;&#1608;&#1583;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;});<br><br> &nbsp; &nbsp;// --- Group Dashboard ---<br> &nbsp; &nbsp;const loadGroupDashboard = async () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;showScreen(&#39;dashboard&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const groupRef = doc(db, `artifacts/${appId}/public/data/groups`, currentGroupId);<br> &nbsp; &nbsp; &nbsp; &nbsp;const unsub = onSnapshot(groupRef, async (docSnap) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (docSnap.exists()) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const group = docSnap.data();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;group-title&#39;).textContent = group.name;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;group-info&#39;).innerHTML = `<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p&gt;&#1575;&#1604;&#1605;&#1576;&#1604;&#1594; &#1575;&#1604;&#1588;&#1607;&#1585;&#1610;: ${group.monthlyAmount.toLocaleString()} &#1583;.&#1593; | &#1593;&#1583;&#1583; &#1575;&#1604;&#1571;&#1593;&#1590;&#1575;&#1569;: ${group.memberCount}&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p&gt;&#1591;&#1585;&#1610;&#1602;&#1577; &#1575;&#1604;&#1583;&#1608;&#1585;: ${group.method === &#39;lottery&#39; ? &#39;&#1602;&#1585;&#1593;&#1577; &#1570;&#1604;&#1610;&#1577;&#39; : &#39;&#1578;&#1585;&#1578;&#1610;&#1576; &#1610;&#1583;&#1608;&#1610;&#39;}&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (group.method === &#39;lottery&#39;) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;lottery-tab-btn&#39;).classList.remove(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;lottery-tab-btn&#39;).classList.add(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;renderMembersTable(group);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1582;&#1591;&#1571;&quot;, &quot;&#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577; &#1594;&#1610;&#1585; &#1605;&#1608;&#1580;&#1608;&#1583;&#1577;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showScreen(&#39;home&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;back-home-btn&#39;).addEventListener(&#39;click&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;unsub();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showScreen(&#39;home&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;}, { once: true });<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;loadChatMessages();<br> &nbsp; &nbsp;};<br><br> &nbsp; &nbsp;const renderMembersTable = (group) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;const tableBody = document.getElementById(&#39;members-table-body&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;tableBody.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp;group.members.forEach(memberId =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const memberRow = document.createElement(&#39;tr&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberRow.className = &#39;bg-white border-b hover:bg-gray-50&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const isPaid = group.payments[memberId] ? true : false;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const hasReceived = group.received.includes(memberId);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const memberName = group.memberNames[memberId] || memberId.substring(0, 8);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const memberCell = document.createElement(&#39;th&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberCell.scope = &#39;row&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberCell.className = &#39;py-4 px-2 font-medium text-gray-900 whitespace-nowrap&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberCell.textContent = memberName;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const paidCell = document.createElement(&#39;td&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;paidCell.className = &#39;py-4 px-2&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const paidIcon = document.createElement(&#39;span&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;paidIcon.className = `payment-status-icon ${isPaid ? &#39;paid-icon&#39; : &#39;unpaid-icon&#39;}`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;paidIcon.textContent = isPaid ? &#39;&#10004;&#65039;&#39; : &#39;&#10060;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;paidCell.appendChild(paidIcon);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const receivedCell = document.createElement(&#39;td&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;receivedCell.className = &#39;py-4 px-2&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;receivedCell.innerHTML = hasReceived ? &#39;&lt;span class=&quot;received-icon&quot;&gt;&#11088;&lt;/span&gt;&#39; : &#39;-&#39;;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberRow.appendChild(memberCell);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberRow.appendChild(paidCell);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;memberRow.appendChild(receivedCell);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tableBody.appendChild(memberRow);<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp;};<br><br> &nbsp; &nbsp;// --- Chat Functionality ---<br> &nbsp; &nbsp;const loadChatMessages = () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;const chatMessagesRef = collection(db, `artifacts/${appId}/public/data/groups/${currentGroupId}/chat`);<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;// This onSnapshot will automatically update the chat when new messages are added<br> &nbsp; &nbsp; &nbsp; &nbsp;onSnapshot(chatMessagesRef, (snapshot) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const chatMessagesContainer = document.getElementById(&#39;chat-messages&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;chatMessagesContainer.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;snapshot.docs.sort((a,b) =&gt; a.data().timestamp - b.data().timestamp).forEach((doc) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const message = doc.data();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const messageElement = document.createElement(&#39;div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageElement.className = `message-bubble ${message.senderId === userId ? &#39;my-message&#39; : &#39;other-message&#39;}`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const senderName = message.senderId === userId ? username : (message.senderName || message.senderId.substring(0, 8));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const messageContent = message.text;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (message.senderId !== userId) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageElement.innerHTML = `&lt;span class=&quot;font-bold text-xs&quot;&gt;${senderName}&lt;/span&gt;&lt;br/&gt;${messageContent}`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageElement.textContent = messageContent;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;chatMessagesContainer.appendChild(messageElement);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp;};<br><br> &nbsp; &nbsp;document.getElementById(&#39;chat-form&#39;).addEventListener(&#39;submit&#39;, async (e) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;e.preventDefault();<br> &nbsp; &nbsp; &nbsp; &nbsp;const chatInput = document.getElementById(&#39;chat-input&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;const messageText = chatInput.value.trim();<br> &nbsp; &nbsp; &nbsp; &nbsp;if (messageText === &quot;&quot;) return;<br><br> &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await addDoc(collection(db, `artifacts/${appId}/public/data/groups/${currentGroupId}/chat`), {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text: messageText,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;senderId: userId,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;senderName: username,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;timestamp: serverTimestamp()<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;chatInput.value = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp;} catch (e) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error sending message:&quot;, e);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1582;&#1591;&#1571;&quot;, &quot;&#1601;&#1588;&#1604; &#1601;&#1610; &#1573;&#1585;&#1587;&#1575;&#1604; &#1575;&#1604;&#1585;&#1587;&#1575;&#1604;&#1577;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;});<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;// --- UI Navigation and Event Listeners ---<br> &nbsp; &nbsp;document.getElementById(&#39;create-group-btn&#39;).addEventListener(&#39;click&#39;, () =&gt; showScreen(&#39;createGroup&#39;));<br> &nbsp; &nbsp;document.getElementById(&#39;join-group-btn&#39;).addEventListener(&#39;click&#39;, () =&gt; showScreen(&#39;joinGroup&#39;));<br> &nbsp; &nbsp;document.getElementById(&#39;cancel-create-group&#39;).addEventListener(&#39;click&#39;, () =&gt; showScreen(&#39;home&#39;));<br> &nbsp; &nbsp;document.getElementById(&#39;cancel-join-group&#39;).addEventListener(&#39;click&#39;, () =&gt; showScreen(&#39;home&#39;));<br><br> &nbsp; &nbsp;document.getElementById(&#39;share-code-btn&#39;).addEventListener(&#39;click&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;const groupCode = currentGroupId;<br> &nbsp; &nbsp; &nbsp; &nbsp;navigator.clipboard.writeText(groupCode)<br> &nbsp; &nbsp; &nbsp; &nbsp;.then(() =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1578;&#1605; &#1575;&#1604;&#1606;&#1587;&#1582;&quot;, `&#1578;&#1605; &#1606;&#1587;&#1582; &#1603;&#1608;&#1583; &#1575;&#1604;&#1580;&#1605;&#1593;&#1610;&#1577;: ${groupCode}`);<br> &nbsp; &nbsp; &nbsp; &nbsp;})<br> &nbsp; &nbsp; &nbsp; &nbsp;.catch(err =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showModal(&quot;&#1582;&#1591;&#1571;&quot;, &quot;&#1601;&#1588;&#1604; &#1601;&#1610; &#1606;&#1587;&#1582; &#1575;&#1604;&#1603;&#1608;&#1583;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp;});<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;const tabs = document.querySelectorAll(&#39;.tab-button&#39;);<br> &nbsp; &nbsp;const tabContents = document.querySelectorAll(&#39;.tab-content&#39;);<br> &nbsp; &nbsp;tabs.forEach(tab =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;tab.addEventListener(&#39;click&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tabs.forEach(t =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;t.classList.remove(&#39;border-green-600&#39;, &#39;text-green-600&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;t.classList.add(&#39;border-transparent&#39;, &#39;text-gray-600&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tabContents.forEach(c =&gt; c.classList.add(&#39;hidden&#39;));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tab.classList.remove(&#39;border-transparent&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tab.classList.add(&#39;border-green-600&#39;, &#39;text-green-600&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(`${tab.dataset.tab}-tab`).classList.remove(&#39;hidden&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp;});<br> &nbsp; &nbsp;document.querySelector(&#39;[data-tab=&quot;dashboard&quot;]&#39;).click();<br><br><br> &nbsp; &nbsp;// Initial app launch<br> &nbsp; &nbsp;document.addEventListener(&#39;DOMContentLoaded&#39;, () =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;appInitializer();<br> &nbsp; &nbsp;});<br>&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></span></p></body></html>